{"timestamp":"2025-09-17T05:21:14.424952","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-17T05:21:14.425281","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/moodle_ldap_sync_and_transform_generic.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-17T05:21:14.488550Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.488768Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.489434Z","level":"info","event":"Current task name:transform_moodle_data","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.489610Z","level":"info","event":"Dag name:moodle_ldap_dynamic_etl_v2","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.489807Z","level":"info","event":"--- Starting Moodle Data Transformation ---","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.490583","level":"warning","event":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py:471: DeprecationWarning: Using Connection.get_connection_from_secrets from `airflow.models` is deprecated.Please use `get` on Connection from sdk(`airflow.sdk.Connection`) instead\n  warnings.warn(\n","logger":"py.warnings"}
{"timestamp":"2025-09-17T05:21:14.494651","level":"info","event":"Connection Retrieved 'mysql_default'","logger":"airflow.hooks.base"}
{"timestamp":"2025-09-17T05:21:14.518272","level":"info","event":"Running statement: DROP TABLE IF EXISTS AUST.moodle_users_cleaned;, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:21:14.520394","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:21:14.523920","level":"info","event":"Running statement: CREATE TABLE AUST.moodle_users_cleaned (`id` BIGINT, `auth` TEXT, `lang` TEXT, `email` TEXT, `theme` TEXT, `fullname` TEXT, `lastname` TEXT, `timezone` TEXT, `username` TEXT, `confirmed` BOOLEAN, `firstname` TEXT, `suspended` BOOLEAN, `department` TEXT, `lastaccess` BIGINT, `mailformat` BIGINT, `description` TEXT, `firstaccess` BIGINT, `trackforums` BIGINT, `profileimageurl` TEXT, `descriptionformat` FLOAT, `profileimageurlsmall` TEXT, `country` TEXT, `preferences` TEXT, PRIMARY KEY (`id`));, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:21:14.542225","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:21:14.552665","level":"error","event":"Task failed with exception","logger":"task","error_detail":[{"exc_type":"OperationalError","exc_value":"(MySQLdb.OperationalError) (1241, 'Operand should contain 1 column(s)')\n[SQL: INSERT INTO `AUST`.moodle_users_cleaned (id, auth, lang, email, theme, fullname, lastname, timezone, username, confirmed, firstname, suspended, department, lastaccess, mailformat, description, firstaccess, trackforums, profileimageurl, descriptionformat, profileimageurlsmall, country, preferences) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]\n[parameters: ((1, 'manual', 'en', 'root@localhost', '', 'Guest user  ', ' ', '99', 'guest', 1, 'Guest user', 0, '', 0, 1, 'This user is a special user that allows read-only access to some courses.', 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', 1.0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (2, 'manual', 'en', 'supermanismebvo123@gmail.com', '', 'Admin User', 'User', 'America/Los_Angeles', 'root', 1, 'Admin', 0, '', 1758086241, 1, '', 1758051733, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', 1.0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', 'US', [{'name': 'assign_filter', 'value': ''}, {'name': 'auth_manual_passwordupdatetime', 'value': '1758051819'}, {'name': 'core_message_migrate_data', 'val ... (745 characters truncated) ... 'userselector_autoselectunique', 'value': '0'}, {'name': 'userselector_preserveselected', 'value': '0'}, {'name': '_lastloaded', 'value': 1758086472}]), (6, 'manual', 'en', 'dbrown@exsample.com', '', 'David Brown', 'Brown', '99', 'dbrown', 1, 'David', 0, '', 1758084135, 1, None, 1758083684, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (7, 'manual', 'en', 'evance@exsample.com', '', 'Eleanor Vance', 'Vance', '99', 'evance', 1, 'Eleanor', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (8, 'manual', 'en', 'jdoe@exsample.com', '', 'Jane Doe', 'Doe', '99', 'jdoe', 1, 'Jane', 0, '', 1758084210, 1, None, 1758084210, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (9, 'manual', 'en', 'jsmith@exsample.com', '', 'John Smith', 'Smith', '99', 'jsmith', 1, 'John', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (10, 'manual', 'en', 'mkane@exsample.com', '', 'Marcus Kane', 'Kane', '99', 'mkane', 1, 'Marcus', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (11, 'manual', 'en', 'mwilliams@exsample.com', '', 'Mary Williams', 'Williams', '99', 'mwilliams', 1, 'Mary', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None)  ... displaying 10 of 13 total bound parameter sets ...  (15, 'manual', 'en', 'ttest@exsample.com', '', 'Test TEST', 'TEST', '99', 'ttest', 1, 'Test', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (16, 'manual', 'en', 'vchase@exsample.com', '', 'Valerie Chase', 'Chase', '99', 'vchase', 1, 'Valerie', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None))]\n(Background on this error at: https://sqlalche.me/e/14/e3q8)","exc_notes":[],"syntax_error":null,"is_cause":false,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":920,"name":"run"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/task_runner.py","lineno":1215,"name":"_execute_task"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/decorator.py","lineno":251,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/bases/operator.py","lineno":397,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":216,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/providers/standard/operators/python.py","lineno":239,"name":"execute_callable"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/airflow/sdk/execution_time/callback_runner.py","lineno":81,"name":"run"},{"filename":"/opt/airflow/dags/moodle_ldap_sync_and_transform_generic.py","lineno":166,"name":"transform_moodle_data"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/util/_decorators.py","lineno":333,"name":"wrapper"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/core/generic.py","lineno":3008,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":788,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1958,"name":"to_sql"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1507,"name":"insert_records"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1498,"name":"insert_records"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":1059,"name":"insert"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/pandas/io/sql.py","lineno":951,"name":"_execute_insert"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1385,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/sql/elements.py","lineno":334,"name":"_execute_on_connection"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1577,"name":"_execute_clauseelement"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1953,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":2134,"name":"_handle_dbapi_exception"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/util/compat.py","lineno":211,"name":"raise_"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1890,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py","lineno":183,"name":"do_executemany"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/cursors.py","lineno":241,"name":"executemany"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/cursors.py","lineno":275,"name":"_do_execute_many"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/cursors.py","lineno":179,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/cursors.py","lineno":330,"name":"_query"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/connections.py","lineno":280,"name":"query"}],"is_group":false,"exceptions":[]},{"exc_type":"OperationalError","exc_value":"(1241, 'Operand should contain 1 column(s)')","exc_notes":[],"syntax_error":null,"is_cause":true,"frames":[{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/engine/base.py","lineno":1890,"name":"_execute_context"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/sqlalchemy/dialects/mysql/mysqldb.py","lineno":183,"name":"do_executemany"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/cursors.py","lineno":241,"name":"executemany"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/cursors.py","lineno":275,"name":"_do_execute_many"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/cursors.py","lineno":179,"name":"execute"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/cursors.py","lineno":330,"name":"_query"},{"filename":"/home/airflow/.local/lib/python3.12/site-packages/MySQLdb/connections.py","lineno":280,"name":"query"}],"is_group":false,"exceptions":[]}]}
{"timestamp":"2025-09-17T05:21:14.553943Z","level":"info","event":"Task instance in failure state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.554156Z","level":"info","event":"Task start","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.554348Z","level":"info","event":"Task:<Task(_PythonDecoratedOperator): transform_moodle_data>","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.554573Z","level":"info","event":"Failure caused by (MySQLdb.OperationalError) (1241, 'Operand should contain 1 column(s)')","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.554771Z","level":"info","event":"[SQL: INSERT INTO `AUST`.moodle_users_cleaned (id, auth, lang, email, theme, fullname, lastname, timezone, username, confirmed, firstname, suspended, department, lastaccess, mailformat, description, firstaccess, trackforums, profileimageurl, descriptionformat, profileimageurlsmall, country, preferences) VALUES (%s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s, %s)]","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.554987Z","level":"info","event":"[parameters: ((1, 'manual', 'en', 'root@localhost', '', 'Guest user  ', ' ', '99', 'guest', 1, 'Guest user', 0, '', 0, 1, 'This user is a special user that allows read-only access to some courses.', 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', 1.0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (2, 'manual', 'en', 'supermanismebvo123@gmail.com', '', 'Admin User', 'User', 'America/Los_Angeles', 'root', 1, 'Admin', 0, '', 1758086241, 1, '', 1758051733, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', 1.0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', 'US', [{'name': 'assign_filter', 'value': ''}, {'name': 'auth_manual_passwordupdatetime', 'value': '1758051819'}, {'name': 'core_message_migrate_data', 'val ... (745 characters truncated) ... 'userselector_autoselectunique', 'value': '0'}, {'name': 'userselector_preserveselected', 'value': '0'}, {'name': '_lastloaded', 'value': 1758086472}]), (6, 'manual', 'en', 'dbrown@exsample.com', '', 'David Brown', 'Brown', '99', 'dbrown', 1, 'David', 0, '', 1758084135, 1, None, 1758083684, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (7, 'manual', 'en', 'evance@exsample.com', '', 'Eleanor Vance', 'Vance', '99', 'evance', 1, 'Eleanor', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (8, 'manual', 'en', 'jdoe@exsample.com', '', 'Jane Doe', 'Doe', '99', 'jdoe', 1, 'Jane', 0, '', 1758084210, 1, None, 1758084210, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (9, 'manual', 'en', 'jsmith@exsample.com', '', 'John Smith', 'Smith', '99', 'jsmith', 1, 'John', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (10, 'manual', 'en', 'mkane@exsample.com', '', 'Marcus Kane', 'Kane', '99', 'mkane', 1, 'Marcus', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (11, 'manual', 'en', 'mwilliams@exsample.com', '', 'Mary Williams', 'Williams', '99', 'mwilliams', 1, 'Mary', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None)  ... displaying 10 of 13 total bound parameter sets ...  (15, 'manual', 'en', 'ttest@exsample.com', '', 'Test TEST', 'TEST', '99', 'ttest', 1, 'Test', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None), (16, 'manual', 'en', 'vchase@exsample.com', '', 'Valerie Chase', 'Chase', '99', 'vchase', 1, 'Valerie', 0, '', 0, 1, None, 0, 0, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f1', None, 'http://host.docker.internal/theme/image.php/boost/core/1758051728/u/f2', None, None))]","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:21:14.555240Z","level":"info","event":"(Background on this error at: https://sqlalche.me/e/14/e3q8)","chan":"stdout","logger":"task"}
