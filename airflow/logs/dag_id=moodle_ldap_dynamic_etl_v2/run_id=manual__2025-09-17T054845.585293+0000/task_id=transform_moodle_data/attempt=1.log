{"timestamp":"2025-09-17T05:48:50.542843","level":"info","event":"DAG bundles loaded: dags-folder, example_dags","logger":"airflow.dag_processing.bundles.manager.DagBundlesManager"}
{"timestamp":"2025-09-17T05:48:50.543175","level":"info","event":"Filling up the DagBag from /opt/airflow/dags/moodle_ldap_sync_and_transform_generic.py","logger":"airflow.models.dagbag.DagBag"}
{"timestamp":"2025-09-17T05:48:50.604176Z","level":"info","event":"Task instance is in running state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.604386Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.QUEUED","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.604818Z","level":"info","event":"Current task name:transform_moodle_data","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.604975Z","level":"info","event":"Dag name:moodle_ldap_dynamic_etl_v2","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.605170Z","level":"info","event":"--- Starting Moodle Data Transformation ---","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.606074","level":"warning","event":"/home/airflow/.local/lib/python3.12/site-packages/airflow/models/connection.py:471: DeprecationWarning: Using Connection.get_connection_from_secrets from `airflow.models` is deprecated.Please use `get` on Connection from sdk(`airflow.sdk.Connection`) instead\n  warnings.warn(\n","logger":"py.warnings"}
{"timestamp":"2025-09-17T05:48:50.609718","level":"info","event":"Connection Retrieved 'mysql_default'","logger":"airflow.hooks.base"}
{"timestamp":"2025-09-17T05:48:50.631476","level":"info","event":"Running statement: DROP TABLE IF EXISTS AUST.moodle_users_cleaned;, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.643253","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.647365","level":"info","event":"Running statement: CREATE TABLE AUST.moodle_users_cleaned (`id` BIGINT, `auth` TEXT, `lang` TEXT, `email` TEXT, `theme` TEXT, `fullname` TEXT, `lastname` TEXT, `timezone` TEXT, `username` TEXT, `confirmed` BOOLEAN, `firstname` TEXT, `suspended` BOOLEAN, `department` TEXT, `lastaccess` BIGINT, `mailformat` BIGINT, `description` TEXT, `firstaccess` BIGINT, `trackforums` BIGINT, `profileimageurl` TEXT, `descriptionformat` FLOAT, `profileimageurlsmall` TEXT, `country` TEXT, `preferences` TEXT, PRIMARY KEY (`id`));, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.665003","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.682743Z","level":"info","event":"Loaded 13 records into AUST.moodle_users_cleaned.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.690103","level":"info","event":"Running statement: DROP TABLE IF EXISTS AUST.moodle_courses_cleaned;, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.702156","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.705997","level":"info","event":"Running statement: CREATE TABLE AUST.moodle_courses_cleaned (`id` BIGINT, `lang` TEXT, `format` TEXT, `enddate` BIGINT, `summary` TEXT, `visible` BIGINT, `fullname` TEXT, `idnumber` TEXT, `maxbytes` BIGINT, `groupmode` BIGINT, `newsitems` BIGINT, `shortname` TEXT, `startdate` BIGINT, `categoryid` BIGINT, `forcetheme` TEXT, `showgrades` BIGINT, `displayname` TEXT, `numsections` BIGINT, `showreports` BIGINT, `timecreated` BIGINT, `timemodified` BIGINT, `summaryformat` BIGINT, `groupmodeforce` BIGINT, `completionnotify` BIGINT, `enablecompletion` BIGINT, `categorysortorder` BIGINT, `defaultgroupingid` BIGINT, `showactivitydates` BOOLEAN, `courseformatoptions` TEXT, `showcompletionconditions` TEXT, `hiddensections` FLOAT, PRIMARY KEY (`id`));, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.723430","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.737121Z","level":"info","event":"Loaded 4 records into AUST.moodle_courses_cleaned.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.743318","level":"info","event":"Running statement: DROP TABLE IF EXISTS AUST.moodle_assignments_cleaned;, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.753851","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.757440","level":"info","event":"Running statement: CREATE TABLE AUST.moodle_assignments_cleaned (`id` BIGINT, `cmid` BIGINT, `name` TEXT, `grade` BIGINT, `intro` TEXT, `course` BIGINT, `configs` TEXT, `duedate` BIGINT, `timelimit` BIGINT, `cutoffdate` BIGINT, `hidegrader` BIGINT, `introfiles` TEXT, `introformat` BIGINT, `maxattempts` BIGINT, `blindmarking` BIGINT, `gradepenalty` BIGINT, `timemodified` BIGINT, `nosubmissions` BIGINT, `gradingduedate` BIGINT, `teamsubmission` BIGINT, `markingworkflow` BIGINT, `completionsubmit` BIGINT, `introattachments` TEXT, `markinganonymous` BIGINT, `revealidentities` BIGINT, `submissiondrafts` BIGINT, `markingallocation` BIGINT, `sendnotifications` BIGINT, `attemptreopenmethod` TEXT, `sendlatenotifications` BIGINT, `submissionattachments` BIGINT, `allowsubmissionsfromdate` BIGINT, `sendstudentnotifications` BIGINT, `teamsubmissiongroupingid` BIGINT, `requiresubmissionstatement` BIGINT, `preventsubmissionnotingroup` BIGINT, `requireallteammemberssubmit` BIGINT, PRIMARY KEY (`id`));, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.777833","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.792093Z","level":"info","event":"Loaded 1 records into AUST.moodle_assignments_cleaned.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.798045","level":"info","event":"Running statement: DROP TABLE IF EXISTS AUST.moodle_submissions_cleaned;, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.808617","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.812136","level":"info","event":"Running statement: CREATE TABLE AUST.moodle_submissions_cleaned (`id` BIGINT, `status` TEXT, `userid` BIGINT, `groupid` BIGINT, `plugins` TEXT, `timecreated` BIGINT, `timestarted` TEXT, `assignmentid` BIGINT, `timemodified` BIGINT, `attemptnumber` BIGINT, `gradingstatus` TEXT, PRIMARY KEY (`id`));, parameters: None","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.827114","level":"info","event":"Rows affected: 0","logger":"airflow.task.hooks.airflow.providers.mysql.hooks.mysql.MySqlHook"}
{"timestamp":"2025-09-17T05:48:50.835630Z","level":"info","event":"Loaded 7 records into AUST.moodle_submissions_cleaned.","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.835807Z","level":"info","event":"--- Moodle Data Transformation Complete ---","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.835970","level":"info","event":"Done. Returned value was: None","logger":"airflow.task.operators.airflow.providers.standard.decorators.python._PythonDecoratedOperator"}
{"timestamp":"2025-09-17T05:48:50.845703Z","level":"info","event":"Task instance in success state","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.845885Z","level":"info","event":" Previous state of the Task instance: TaskInstanceState.RUNNING","chan":"stdout","logger":"task"}
{"timestamp":"2025-09-17T05:48:50.846112Z","level":"info","event":"Task operator:<Task(_PythonDecoratedOperator): transform_moodle_data>","chan":"stdout","logger":"task"}
